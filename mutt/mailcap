# vim: filetype=mailcap
# MIME type handlers for neomutt

# HTML emails - html-to-markdown (Rust, fast) then glow renders
text/html; html-to-markdown | CLICOLOR_FORCE=1 glow -s dark; copiousoutput;

# Markdown emails - render with glow
text/markdown; CLICOLOR_FORCE=1 glow -s dark %s; copiousoutput;

# Calendar invites - render inline
text/calendar; render-calendar-attachment.py %s; copiousoutput;
application/ics; mutt-viewical; copiousoutput;

# Open images externally (macOS)
image/*; open %s;

# Open videos in default player (macOS)
video/*; open %s;

# Open PDFs externally (macOS)
application/pdf; open %s;

# Open spreadsheets externally (macOS)
application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; open %s;
application/vnd.ms-excel; open %s;

# Open Word documents externally (macOS)
application/vnd.openxmlformats-officedocument.wordprocessingml.document; open %s;
application/msword; open %s;

# Open PowerPoint externally (macOS)
application/vnd.openxmlformats-officedocument.presentationml.presentation; open %s;
application/vnd.ms-powerpoint; open %s;

# Fallback for any other files - open with system default
application/*; open %s;
